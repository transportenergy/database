# N.B. this file configures Travis to test *both* the Python and R item codes.
#
# References:
# - The Travis documentation: https://docs.travis-ci.com/
# - Example .travis.yml for a popular R package:
#   https://github.com/tidyverse/ggplot2/blob/master/.travis.yml
# - The community-developed R support for Travis:
#   - https://github.com/travis-ci/travis-build , in particular the file:
#     lib/travis/build/script/r.rb
#   - Example output: https://travis-ci.org/tidyverse/ggplot2/jobs/232365761

dist: xenial

language: r

cache:
  directories:
    - $HOME/.cache/pip
    - $HOME/R/Library

python:
  - 3.7

r: release

install:
  - Rscript -e 'withr::with_libpaths(Sys.getenv("R_LIBS_USER"), devtools::install_deps("R/item"))'
  - Rscript -e 'devtools::session_info(installed.packages()[, "Package"])'
  - pip install -r ci/requirements.txt
  - pip install codecov pytest-cov

script:
   - R CMD check R/item
   - py.test python/item --cov=item --cov-report term-missing

after_success:
  - coverage combine
  - codecov

notifications:
  email: false
